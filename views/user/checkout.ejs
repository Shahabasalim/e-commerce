<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
		integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
		crossorigin="anonymous" referrerpolicy="no-referrer" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
		integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
		crossorigin="anonymous" referrerpolicy="no-referrer" />
	<!--===============================================================================================-->
	<link rel="icon" type="image/png" href="images/icons/favicon.png" />
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/linearicons-v1.0.0/icon-font.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/slick/slick.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/MagnificPopup/magnific-popup.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/perfect-scrollbar/perfect-scrollbar.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/util.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" href="/css/checkout.css">
</head>
<body>
    <%- include('header') -%>
    <main>
      <!-- Modal -->
      <div
      class="modal fade"
      id="changeAddressModal"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="background-color: white; border-radius: 8px; border: none; margin-top: 100px;">
          <div class="modal-header" style="border-bottom: none; padding-bottom: 0;">
            <h5 class="modal-title" id="exampleModalLabel" style="font-weight: bold; color: #333;">Address</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
              style="background-color: transparent; border: none;"
            ></button>
          </div>
          <div class="modal-body" style="padding-top: 0;">
            <% addresses?.address?.forEach(data => { %>
              <label style="display: flex; align-items: center; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                <input type="radio" name="address" value="<%= data.id %>" style="margin-right: 10px;">
                <span style="color: #555;"><%= data.name %> <%= data.locality %> <%= data.address %> <%= data.district %></span>
              </label>
            <% }); %>
            <p class="m-0"><a href="/address" style="color: #007bff; text-decoration: none;">Add Address</a></p>
          </div>
          <div class="modal-footer" style="border-top: none; justify-content: space-between;">
            <button
              onclick="changeAddress()"
              style="background-color: #dc3545; height: 35px; width: 55px; border-radius: 4px; color: white; border: none;"
            >
              Add
            </button>
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
              style="background-color: #6c757d; color: white; border: none;"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    
      <!-- end of Modal -->
      <div class="container-fluid main">
        <div class="row mainContainer">
          <div class="col-12">
            <div class="cartBody d-flex">
              <div class="col-6 oneSection">
                <div class="cartItems">
                  <!-- <div class="items position-relative mb-3">
                    <div class="d-flex payOptions align-items-center gap-3">
                      <input
                        class="pay"
                        name="payMethode"
                        value="OP"
                        type="radio"
                        id="creditCard"
                      />
                      <h2 class="m-0">Credit Card</h2>
                    </div>
                    <div class="credit">
                      <label for="cCNo" class="d-block"
                        >Credit card number</label
                      >
                      <input type="number" name="cCNo" />
                      <div class="d-flex gap-3 w-100">
                        <div class="w-50">
                          <label for="expiry" class="d-block"
                            >Expiry (MM/YY)</label
                          >
                          <input type="text" class="w-100" name="expiry" />
                        </div>
                        <div class="w-50">
                          <label for="CVV" class="d-block">CVV</label>
                          <input type="number" class="w-100" name="CVV" />
                        </div>
                      </div>
                      <label for="nOC" class="d-block">Name on the card</label>
                      <input type="number" name="nOC" />
                    </div>
                  </div> -->

                  <div class="items position-relative mb-3">
                    <div class="d-flex payOptions align-items-center gap-3">
                      <input
                        class="pay"
                        name="payMethode"
                        value="COD"
                        type="radio"
                        id="COD"
                      />
                      <h2 class="m-0">Cash On Delivery (COD)</h2>
                    </div>
                  </div>

                  <div class="orderSummary m-0 w-100">
                    <div class="orderHeading">
                      <h2>Delivery Address</h2>
                    </div>
                     <% if(addresses){%>
                      <div class="chooseAdd position-relative">
                        
                        <div class="existingAddress">
                          <p id="addressName" class="adressname">Name: <%= addresses?.address[0]?.name %></p>

                          <p id="addressLocality" class="adressname">Locality: <%= addresses?.address[0]?.locality %></p>

                          <p id="addressDistrict" class="adressname"> District: <%= addresses?.address[0]?.district %></p>

                          <p id="addressAddress" class="adressname"> Address: <%= addresses?.address[0]?.address %></p>

                          <p id="addressCity" class="adressname">City: <%= addresses?.address[0]?.city %></p>

                          <p id="addressPin" class="adressname">Pincode: <%= addresses?.address[0]?.pincode %></p>

                          <p id="addressPhone" class="adressname">Phonenumber: <%= addresses?.address[0]?.phonenumber %></p>
                        </div>
                        <a
                          href="/userChangeAddress"
                          data-bs-toggle="modal"
                          data-bs-target="#changeAddressModal"
                        > 
                          <button class="position-absolute button">
                            Change
                          </button>
                        </a>
                      </div>
                      <% } %>
                      
            
                   
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 oneSection">
                <div class="orderSummary">
                  <div class="orderHeading">
                    <h2>order summary</h2>
                  </div>
                  <div class="orderContent">
                    <div
                      class="sTotal d-flex justify-content-between align-items-center"
                    >
                      <p class="commonText m-0 p-0">Subtotal</p>
                      <p class="commonSub m-0 p-0" id="sTotal">₹27,598</p>
                    </div>

                    <div
                      class="ship d-flex justify-content-between align-items-center"
                    >
                      <p class="commonText m-0 p-0">Shipping</p>
                      <p class="commonSub m-0 p-0" id="free">FREE</p>
                    </div>

                    <!-- <div
                      class="ship d-flex justify-content-between align-items-center"
                    >
                      <p class="commonText m-0 p-0">Discount</p>
                      <p class="commonSub m-0 p-0" id="dPrice">-19,600</p>
                    </div> -->

                   
                  </div>
                  <div
                    class="commonText tPrice d-flex justify-content-between align-items-center"
                  >
                    <p class="m-0 p-0">Total</p>
                    <p class="m-0 p-0" id="tPrice">₹7,998</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="container-fluid">
        <div class="row">
          <div class="col-12">
            <div class="checkOut">

              <button id="proceedToPaymentBtn">Proceed to payment</button>
            </div>
          </div>
        </div>
      </div>
    </main>
    <!-- end of main -->



    <!-- custom js -->
    <script src="./js/userPayment.js"></script>
    <!-- end of custom js -->
    <!-- fontawesome -->
    <script
      src="https://kit.fontawesome.com/23d1247997.js"
      crossorigin="anonymous"
    ></script>
    <!-- end of fontawesome -->
    <!-- Bootstrap script file -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    <!--end of Bootstrap script file -->
  </body>
</html>

    
</body>
</html>


<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  document.getElementById('proceedToPaymentBtn').addEventListener('click', function() {
    // Replace this with your actual payment logic if needed

    // Example SweetAlert2 usage
    Swal.fire({
      title: 'Thank You!',
      text: 'Order Placed',
      icon: 'success',
      showCancelButton: false,
      confirmButtonColor: '#3085d6',
      confirmButtonText: 'OK'
    }).then((result) => {
      // Optionally, you can redirect to a payment page or perform other actions after confirmation
      if (result.isConfirmed) {
        // Redirect to payment page or any other action
        window.location.href = '/'; // Example redirect
      }
    });
  });
</script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.2/axios.min.js" integrity="sha512-JSCFHhKDilTRRXe9ak/FJ28dcpOJxzQaCd3Xg8MyF6XFjODhy/YMCM8HW0TFDckNHWUewW+kfvhin43hKtJxAw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
  const radio = document.querySelectorAll('.radio');radio.forEach((element) => {
  element.addEventListener('change', () => {
    const data = element.value;
    console.log(data);
  })
});

const addressName = document.getElementById('addressName')
const addressLocality = document.getElementById('addressLocality')
const addressDistrict = document.getElementById('addressDistrict')
const addressAddress = document.getElementById('addressAddress')
const addressCity = document.getElementById('addressCity')
const addressPin = document.getElementById('addressPin')
const addressPhone = document.getElementById('addressPhone')

console.log(addressAddress.innerHTML);

async function changeAddress() {
  const selectedOption = document.querySelector('input[name="address"]:checked');
  if(selectedOption) {
    const selectedAddress = await axios.post('/checkout/change-address', {addressId: selectedOption.value})
    const address = selectedAddress.data.address.address[0]
    addressName.innerHTML = `name: ${ address.name}`
    addressLocality.innerHTML = address.locality
    addressDistrict.innerHTML = address.district
    addressAddress.innerHTML=address.address
    addressCity.innerHTML=address.city
    addressPin.innerHTML=address.pincode
    addressPhone.innerHTML=address.phonenumber
  }

}





</script> 